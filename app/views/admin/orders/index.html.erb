<div>
  <%= flash[:notice] %>
</div>

<h2>注文履歴一覧</h2>

<div class="container">
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>購入日時</th>
        <th>購入者</th>
        <th>注文個数</th>
        <th>注文ステータス</th>
      </tr>
    </thead>
    <tbody>
  <% @orders.each do |order| %>
    <tr>
      <td><%= link_to order.created_at.strftime("%Y/%m/%d %H:%M"), admin_order_path(order.id) %></td>
      <td><%= order.customer.family_name %><%= order.customer.first_name %></td>
      <td><%= order.order_detail.sum(:amount_ordered) %></td>
      <td>
        <%= form_with model: order, url: admin_order_path(order), method: :patch do |f| %>
        <%= f.select :order_status, Order.statuses.keys.map { |status| [I18n.t("activerecord.attributes.order.order_status.#{status}"), status] }, class: "form-control" %>
        <%= f.submit "更新", class: "btn btn-primary" %>
        <% end %>
      </td>
    </tr>
  <% end %>
 </tbody>
</table>